# EMR Helper - 사용자 가이드

## Python 없이 바로 사용하기

이 프로그램은 실행 파일(.exe)로 빌드되어 **Python 설치 없이** 바로 사용할 수 있습니다.

## 배포된 파일 받았을 때

### 폴더 구조
```
EMR_Helper/
├── EMR_Helper.exe      # 실행 파일
├── 실행.bat             # 실행 스크립트 (더블클릭)
├── config.json         # 설정 파일
├── images/             # EMR 템플릿 이미지
└── [기타 DLL 파일들]
```

### 사용 방법

1. **실행**
   - `EMR_Helper.exe` 또는 `실행.bat` 더블클릭
   - 콘솔 창이 열리며 프로그램이 시작됩니다

2. **첫 실행**
   - EasyOCR 모델 다운로드로 시간이 걸릴 수 있습니다 (1~2분)
   - 두 번째 실행부터는 빠릅니다

3. **EMR 화면에서 사용**
   ```
   1. EMR 프로그램에서 환자 치료 화면을 엽니다
   2. 화면에 다음 정보가 표시되어 있는지 확인:
      - 환자 등록번호, 이름
      - 치료실, 팀
      - 치료 정보 (부위, 선량, Fx 등)
      - Image Guide, Gating
   3. Ctrl+Shift+A 키를 누릅니다
   4. 프로그램이 자동으로:
      - 화면 캡처
      - OCR로 정보 추출
      - 메시지 생성
      - 자동 입력
   ```

4. **종료**
   - ESC 키를 눌러 프로그램 종료

## 생성되는 메시지 예시

```
안녕하세요 선생님~
2치료실 Z팀 조병헌님 71046541 RLL RF 39.6Gy/18Fx G1->G2 NG
첫 치료 영상 저장했습니다.
Offline review 확인 부탁드립니다~
```

## 설정 변경

`config.json` 파일을 메모장으로 열어 수정:

```json
{
  "ocr_mode": true,              // OCR 모드 on/off
  "hotkey": "ctrl+shift+a",      // 단축키 변경
  "auto_type_after_extraction": true,  // 자동 입력 여부
  "debug_mode": false            // 디버그 모드
}
```

### 단축키 변경 예시
- `ctrl+shift+a` (기본값)
- `alt+z`
- `ctrl+alt+q`

### OCR 모드 끄기
단순히 메시지만 입력하려면:
```json
{
  "ocr_mode": false
}
```

## 트러블슈팅

### 프로그램이 실행되지 않을 때

1. **Windows Defender 경고**
   - "Windows의 PC 보호" 창이 뜨면
   - "추가 정보" → "실행" 클릭

2. **관리자 권한으로 실행**
   - EMR_Helper.exe 우클릭
   - "관리자 권한으로 실행"

### OCR이 정보를 못 찾을 때

1. **디버그 모드 켜기**
   ```json
   {
     "debug_mode": true
   }
   ```
   추출된 정보를 확인할 수 있습니다

2. **화면 해상도 확인**
   - EMR 화면이 너무 작거나 크면 인식률이 떨어집니다
   - 100~150% 배율 권장

3. **수동 모드 사용**
   - OCR이 작동하지 않으면 단순 모드로 전환:
   ```json
   {
     "ocr_mode": false,
     "message_template": "안녕하세요 선생님,\n메시지 내용..."
   }
   ```

### 단축키가 작동하지 않을 때

- 다른 프로그램과 단축키 충돌 확인
- config.json에서 단축키 변경

## 주의사항

1. **개인정보 보호**
   - 환자 정보가 포함되므로 주의해서 사용하세요

2. **메시지 확인**
   - OCR은 100% 정확하지 않습니다
   - 생성된 메시지를 확인 후 전송하세요

3. **병원 규정 준수**
   - 자동화 도구 사용이 규정에 위배되지 않는지 확인하세요

## 문의

문제가 있거나 개선 사항이 있으면 개발자에게 문의하세요.
